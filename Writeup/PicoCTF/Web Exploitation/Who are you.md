## Challenge Name: Who are you?
>Category: Web Exploitation

>Points: 100

>Solves: 14k+

Challenge Description: 
Let me in. Let me iiiiiiinnnnnnnnnnnnnnnnnnnn http://mercury.picoctf.net:39114/

Artifact Files:
-

### Approach

**1. Analisis Website**

Pertama kita lihat dulu websitenya. Hanya website HTML biasa dengan meme di dalamnya.
![website](Who%20are%20you-1.JPG)

**2. Faking Browser**

Dari teks warna merah ini bisa menjadi hint buat apa yang harus dilakukan. Intinya flagnya cuma bisa diakses via PicoBrowser.

Tapi kan PicoBrowser gaada!

Nah itu dia tugas kita. Kita harus ngakalin gimana caranya biar server ngira kita ngebuka halamannya dari PicoBrowser padahal bukan.

Caranya gimana?

Jadi ku pernah dapat trik ini dari temenku (Ini cara terlarang sih, bisa dipake buat nge bypass SafeExamBrowser kalau validasi di servernya jelek). Caranya yakni dengan ngeganti header request di key ```User-Agent``` menjadi browser yang menjadi target impersonasi.

Nah biar gampang ngubah-ngubahnya, kita mending pake Postman aja.
![postman](Who%20are%20you-2.JPG)
Pergi ke tab ```Headers``` lalu tambahkan key ```User-Agent``` dan value ```PicoBrowser```. Terakhir tekan ```Send```.
![User-Agent](Who%20are%20you-3.JPG)
Untuk mempermudah melihat hasilnya, tekan ```Preview``` di response. Dari sini terlihat isi teks merahnya berubah menjadi ```I don't trust users visiting from another site.```. Artinya teknik kita sudah benar namun sepertinya masih jauh dari flag.

**2. Faking Source Site**

Nah sekarang kita perlu memikirkan gimana cara bypass source site.

Nah ku selama nge-wengdev sering lihat lihat Network request di developer tool dan di Header suka lihat yang namanya ```Referer```. Dari namanya sepertinya ini buat menandakan ini request nyampe sini dari mana. (Idk, maybe buat proxy dsb?). Kita cobain saja lah. Kita masukin referernya dari websitenya sendiri saja wkwkw.
![Referer](Who%20are%20you-4.JPG)
Yes berubah berarti bener. Dan tentu saja masih belum nyampe flag.

**3. Faking Date**

Sekarang saatnya malsuin tanggal. Kalo kita iseng masukin ```Date``` ke key Postman, ternyata muncul di rekomendasi yang berarti ini header yang valid. Tapi formatnya gimana? mari kita [baca-baca](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Date).

Dari dokumentasi, kita bisa bikin Date palsu yang penting tahunnya 2018. Misal:
```
Wed, 21 Oct 2018 07:28:00 GMT
```
Mari kita kirim.
![Date](Who%20are%20you-5.JPG)
Dan berubah! Perjalanan kita masih panjang bung.

**4. Plz Stop Tracking ME**

Sekarang kita perlu request yang bisa ngasih tahu server supaya gak ngetrack kita. Tapi Apa?

Setelah searching ternyata [ketemu](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/DNT)!

Namanya adalah ```DNT```. Agar tidak di-_track_, kita assign value 1 ke DNT. Mari kita coba.
![DNT](Who%20are%20you-6.JPG)
Henshin!!! Sepertinya selanjutnya kita perlu menjadi Bjorka.

**5. I'm Bjorka**

Sekarang kita perlu ngaku ngaku kalau kita orang swedia. Tapi gimana? kita perlu ngasih sesuatu yang bisa dicek kalau ini benar benar dari swedia.

Ku kepikiran dua hal, antara koordinat geografis atau gak IP public.

Setelah searching ku gak nemu header official yang bisa ngasih koordinat geografis atau negara asal, mungkin buat alasan keamanan. Jadi tinggal IP publik. Tapi header apa?

Setelah searching akhirya nemu. Namanya adalah [X-Forwarded-For](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For). Sekarang tinggal nyari ip nya. Mari kita cari ip publik dari swedia.

Setelah searching, ku nemu website [ini](https://lite.ip2location.com/sweden-ip-address-ranges). Kita tinggal copas 1 IP dan masukkan ke header. Dalam kasus ini ku pilih ```103.45.246.0```
![X-Forwarded-For](Who%20are%20you-7.JPG)
Dan kita sukses menjadi Bjorka. Tinggal perlu belajar bahasanya.

**6. Surstr√∂mming**

Sekarang saatnya belajar bahasa IKEA. Setelah searching header request yang bisa dipakai adalah [Accept-Language](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language). Untuk kode bahasa swedia bisa dicari [di sini](https://www.w3schools.com/tags/ref_language_codes.asp). Kodenya adalah ```sv```.

Mari kita input
![Accept-Language and flag](Who%20are%20you-8.JPG)
Dan...ketemu flagnya! Alhamdulillah.

Flagnya adalah:
```
picoCTF{http_h34d3rs_v3ry_c0Ol_much_w0w_20ace0e4}
```

### Reflections
Lumayan menarik belajar request header dari yang biasa sampai aneh-aneh. Belajar ngelabuin identitas.

---
[Back to home](../Readme.md)
